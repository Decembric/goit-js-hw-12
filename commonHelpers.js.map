{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\naxios.defaults.baseURL = 'https://pixabay.com/';\nconst API_KEY = '42373349-27b23dee84583d41aca0b8d31';\n\n\nexport default async function getPicture(query, page = 1) {\n  const response = await axios.get('api/', {\n    params: {\n      key: API_KEY,\n      per_page: 15,\n      page,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n    },\n  });\n  return response.data;\n}","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionDelay: 250,\n  captionsData: 'alt',\n  enableKeyboard: true,\n});\nimport { hitsContainer } from \"../main\";\n\nexport default function render(hits) {\n  const hitsRef = hits.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n    return `<li><a href=\"${largeImageURL}\"><img src=\"${webformatURL}\" alt=\"${tags}\"/></a></li>\n          <li><p>Likes ${likes}</p></li>\n          <li>\n            <p>Views ${views}</p>\n          </li>\n          <li><p>Comments ${comments}</p></li>\n          <li><p>Downloads ${downloads}</p></li>`\n  });\n  hitsContainer.insertAdjacentHTML('beforeend', hitsRef.join(''));\n  lightbox.refresh();\n};","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport getPicture from \"./js/pixabay-api\";\nimport render from \"./js/render-functions\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst hitsContainer = document.querySelector('.gallery');\nexport { hitsContainer };\n\nconst inputQueryRef = document.querySelector('input');\nconst formRef = document.querySelector('form');\nconst loadMoreButtonRef = document.querySelector('.loader-button');\nconst loaderRef = document.querySelector('.loader');\nconst imagePerPage = 15;\nlet currentQuery = '';\nlet currentPage = 1;\nlet totalPages = undefined;\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionDelay: 250,\n  captionsData: 'alt',\n  enableKeyboard: true,\n});\n\nfunction onShowLoader() {\n  loaderRef.style.display = 'block';\n}\n\nfunction onHideLoader() {\n  loaderRef.style.display = 'none';\n}\n\nloadMoreButtonRef.addEventListener('click', onLoadMore);\nformRef.addEventListener('submit', onInputQuery);\n\nfunction emptyQuery() {\n  iziToast.show({\n    title: 'Error',\n    message: 'Please, enter a non-blank line',\n    titleSize: '16px',\n    titleLineHeight: '150%',\n    messageSize: '16px',\n    messageLineHeight: '150%',\n    backgroundColor: '#ef4040',\n    position: 'bottomRight',\n  });\n}\n\nfunction noImage() {\n  iziToast.show({\n    title: 'Error',\n    message: 'Sorry, there are no images matching your search query. Please try again!',\n    titleSize: '16px',\n    titleLineHeight: '150%',\n    messageSize: '16px',\n    messageLineHeight: '150%',\n    backgroundColor: '#ef4040',\n    position: 'bottomRight',\n  });\n}\n\nfunction endOfCollections() {\n  iziToast.show({\n    title: 'Error',\n    message: \"We're sorry, but you've reached the end of search results.\",\n    titleSize: '16px',\n    titleLineHeight: '150%',\n    messageSize: '16px',\n    messageLineHeight: '150%',\n    backgroundColor: '#ef4040',\n    position: 'bottomRight',\n  });\n}\n\nfunction logMessage(message) {\n  iziToast.show({\n    title: 'Error',\n    message,\n    titleSize: '16px',\n    titleLineHeight: '150%',\n    messageSize: '16px',\n    messageLineHeight: '150%',\n    backgroundColor: '#ef4040',\n    position: 'bottomRight',\n  });\n}\n\nasync function onInputQuery(evt) {\n  evt.preventDefault();\n  const query = evt.currentTarget.elements.query.value.trim();\n  try {\n    if (query === '') {\n      hitsContainer.innerHTML = \"\";\n      emptyQuery();\n      loadMoreButtonRef.hidden = true;\n      currentPage = 1; // Reset currentPage when initiating a new search\n      return;\n    }\n    onShowLoader();\n    currentQuery = query;\n    currentPage = 1; // Reset currentPage when initiating a new search\n    const { hits, totalHits } = await getPicture(currentQuery, currentPage);\n    if (totalHits > 0) {\n      render(hits);\n      onHideLoader();\n      lightbox.refresh();\n      const { height: cardHeight } = hitsContainer.getBoundingClientRect();\n      window.scrollBy({\n        top: cardHeight * 2,\n        behavior: \"smooth\",\n      });\n      inputQueryRef.value = \"\";\n      loadMoreButtonRef.hidden = false;\n      totalPages = Math.ceil(totalHits / imagePerPage);\n    } else {\n      hitsContainer.innerHTML = \"\";\n      noImage();\n    }\n  } catch (message) {\n    onHideLoader();\n    logMessage(message);\n  }\n}\n\nasync function onLoadMore() {\n  try {\n    onShowLoader();\n    currentPage += 1;\n    const { hits, totalHits } = await getPicture(currentQuery, currentPage);\n    render(hits);\n    const element = hitsContainer.firstElementChild.getBoundingClientRect();\n    window.scrollBy({\n      top: element.height,\n      behavior: \"smooth\",\n    });\n    lightbox.refresh();\n    if (Math.ceil(totalHits / imagePerPage) !== currentPage) {\n      loadMoreButtonRef.hidden = true;\n      onHideLoader();\n      endOfCollections();\n    } \n  } catch (message) {\n    onHideLoader();\n    logMessage(message);\n  }\n}"],"names":["axios","API_KEY","getPicture","query","page","lightbox","SimpleLightbox","render","hits","hitsRef","webformatURL","largeImageURL","tags","likes","views","comments","downloads","hitsContainer","inputQueryRef","formRef","loadMoreButtonRef","loaderRef","imagePerPage","currentQuery","currentPage","totalPages","onShowLoader","onHideLoader","onLoadMore","onInputQuery","emptyQuery","iziToast","noImage","endOfCollections","logMessage","message","evt","totalHits","cardHeight","element"],"mappings":"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"}